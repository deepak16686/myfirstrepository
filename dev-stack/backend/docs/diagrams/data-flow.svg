<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700" width="1000" height="700">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
  </defs>

  <rect width="1000" height="700" fill="#f8fafc"/>

  <rect x="0" y="0" width="1000" height="50" fill="#0ea5e9"/>
  <text x="500" y="32" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="white">Pipeline Generator - Data Flow Diagram</text>

  <circle cx="100" cy="150" r="45" fill="#dbeafe" stroke="#3b82f6" stroke-width="3"/>
  <text x="100" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1e40af">User</text>
  <text x="100" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#3b82f6">Developer</text>

  <line x1="145" y1="150" x2="220" y2="150" stroke="#475569" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="182" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Repo URL</text>

  <rect x="230" y="100" width="150" height="100" rx="12" fill="#c7d2fe" stroke="#6366f1" stroke-width="2"/>
  <text x="305" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4338ca">Open-WebUI</text>
  <text x="305" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6366f1">Port: 3001</text>
  <text x="305" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#818cf8">Pipeline Generator Tool</text>

  <line x1="380" y1="150" x2="455" y2="150" stroke="#475569" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="417" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">API Call</text>

  <rect x="465" y="80" width="180" height="140" rx="12" fill="#bbf7d0" stroke="#22c55e" stroke-width="3"/>
  <rect x="465" y="80" width="180" height="35" rx="12" fill="#22c55e"/>
  <text x="555" y="104" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">DevOps Backend</text>
  <text x="555" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#166534">Port: 8003</text>
  <text x="555" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#15803d">/api/v1/pipeline/analyze</text>
  <text x="555" y="172" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#15803d">/api/v1/pipeline/generate</text>
  <text x="555" y="189" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#15803d">/api/v1/pipeline/commit</text>
  <text x="555" y="206" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#15803d">/api/v1/pipeline/feedback</text>

  <path d="M 645 120 Q 720 90 795 120" fill="none" stroke="#f97316" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="720" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ea580c">1. Fetch Files</text>

  <rect x="805" y="80" width="140" height="90" rx="12" fill="#fed7aa" stroke="#f97316" stroke-width="2"/>
  <text x="875" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#c2410c">GitLab</text>
  <text x="875" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#ea580c">Port: 8929</text>
  <text x="875" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#f97316">Repository + CI/CD</text>

  <line x1="555" y1="220" x2="555" y2="290" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="590" y="260" font-family="Arial, sans-serif" font-size="10" fill="#7c3aed">2. Get Feedback</text>

  <rect x="465" y="300" width="180" height="80" rx="12" fill="#e9d5ff" stroke="#8b5cf6" stroke-width="2"/>
  <text x="555" y="330" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#6b21a8">ChromaDB</text>
  <text x="555" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7c3aed">Port: 8000</text>
  <text x="555" y="368" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a855f7">Vector Store (RL Feedback)</text>

  <path d="M 465 180 L 340 320" fill="none" stroke="#1e293b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="380" y="240" font-family="Arial, sans-serif" font-size="10" fill="#334155">3. Generate</text>

  <rect x="180" y="300" width="160" height="90" rx="12" fill="#1e293b" stroke="#0f172a" stroke-width="2"/>
  <text x="260" y="330" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Ollama LLM</text>
  <text x="260" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8">Port: 11434</text>
  <text x="260" y="370" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">qwen2.5-coder:32b</text>

  <line x1="260" y1="390" x2="260" y2="450" stroke="#1e293b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="300" y="425" font-family="Arial, sans-serif" font-size="10" fill="#334155">Generated Files</text>

  <rect x="180" y="460" width="160" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="260" y="485" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#92400e">Output Files</text>
  <text x="260" y="505" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#b45309">.gitlab-ci.yml + Dockerfile</text>

  <path d="M 340 495 Q 420 495 465 200" fill="none" stroke="#475569" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="420" y="380" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Return</text>

  <path d="M 645 180 Q 750 280 875 170" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="780" y="240" font-family="Arial, sans-serif" font-size="10" fill="#16a34a">4. Create Branch</text>
  <text x="780" y="255" font-family="Arial, sans-serif" font-size="10" fill="#16a34a">and Commit Files</text>

  <rect x="805" y="190" width="140" height="60" rx="8" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="875" y="218" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#166534">Pipeline</text>
  <text x="875" y="238" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#22c55e">Triggered!</text>

  <rect x="680" y="400" width="280" height="130" rx="12" fill="#fef2f2" stroke="#ef4444" stroke-width="2"/>
  <rect x="680" y="400" width="280" height="30" rx="12" fill="#ef4444"/>
  <text x="820" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Feedback Loop (If Pipeline Fails)</text>
  <text x="700" y="452" font-family="Arial, sans-serif" font-size="11" fill="#991b1b">1. DevOps engineer fixes pipeline</text>
  <text x="700" y="472" font-family="Arial, sans-serif" font-size="11" fill="#991b1b">2. Call /api/v1/pipeline/feedback</text>
  <text x="700" y="492" font-family="Arial, sans-serif" font-size="11" fill="#991b1b">3. Compare original vs fixed files</text>
  <text x="700" y="512" font-family="Arial, sans-serif" font-size="11" fill="#991b1b">4. Store diff in ChromaDB for RL</text>

  <path d="M 680 465 Q 620 420 610 380" fill="none" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowRed)"/>
  <text x="620" y="430" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">Store</text>

  <rect x="50" y="560" width="280" height="110" rx="8" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="65" y="585" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#334155">Legend</text>
  <line x1="60" y1="595" x2="320" y2="595" stroke="#e2e8f0" stroke-width="1"/>
  <line x1="70" y1="615" x2="110" y2="615" stroke="#475569" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="125" y="620" font-family="Arial, sans-serif" font-size="11" fill="#475569">Data Flow</text>
  <line x1="70" y1="640" x2="110" y2="640" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="125" y="645" font-family="Arial, sans-serif" font-size="11" fill="#ef4444">Feedback Loop</text>
  <circle cx="225" cy="615" r="12" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
  <text x="245" y="620" font-family="Arial, sans-serif" font-size="11" fill="#3b82f6">Actor</text>
  <rect x="205" y="633" width="30" height="16" rx="3" fill="#bbf7d0" stroke="#22c55e" stroke-width="1"/>
  <text x="245" y="645" font-family="Arial, sans-serif" font-size="11" fill="#166534">Service</text>

  <rect x="370" y="560" width="260" height="110" rx="8" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  <text x="385" y="585" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#334155">Service Ports</text>
  <line x1="380" y1="595" x2="620" y2="595" stroke="#e2e8f0" stroke-width="1"/>
  <text x="390" y="615" font-family="Arial, sans-serif" font-size="11" fill="#475569">Open-WebUI: 3001</text>
  <text x="390" y="633" font-family="Arial, sans-serif" font-size="11" fill="#475569">DevOps Backend: 8003</text>
  <text x="390" y="651" font-family="Arial, sans-serif" font-size="11" fill="#475569">GitLab: 8929</text>
  <text x="510" y="615" font-family="Arial, sans-serif" font-size="11" fill="#475569">Ollama: 11434</text>
  <text x="510" y="633" font-family="Arial, sans-serif" font-size="11" fill="#475569">ChromaDB: 8000</text>
  <text x="510" y="651" font-family="Arial, sans-serif" font-size="11" fill="#475569">Trivy: 8083</text>
</svg>
